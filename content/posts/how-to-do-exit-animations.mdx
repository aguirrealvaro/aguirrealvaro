---
title: How to do exit animations on React
description: My take on adding animations when a react component unmounts. Without any animation library.
publishedAt: 2023-06-19
enabled: false
---

**gif**

### Introduction

Throughout my career, in the projects I've worked on, giving animation to the unmounting of a component is not something that is given much importance. Even some component libraries don't do it.

Some people think that exit animations are too much and that components should simply disappear. Maybe it's because implementing an exit animation is not as simple as giving it an entrance animation.
In my opinion, a component with an enter animation should have an exit animation. Otherwise, it feels broken.

In this article, I will be explaining how to do it in a Dialog component, but it can be used for whatever is needed, for example, components like Popovers, Tooltips, etc. First, I will go with a simple example, and then with a more complex, comprehensive, and reusable one. I will be using styled components for the styles, but you can use any other styling library you prefer.

### Without animation

First, we will go with simple example with no animations. Just a state `isOpen` which determines if the Dialog is mounted or not:

```
const App = () => {
  const [isOpen, setIsOpen] = React.useState(false);

  const onOpen = () => setIsOpen(true);
  const onClose = () => setIsOpen(false);

  return (
    <div>
      <button onClick={onOpen}>Open Dialog</button>
      {isOpen && <Dialog onClose={onClose}>Dialog content</Dialog>}
    </div>
  );
};
```

```
type DialogProps = {
  children: React.ReactNode;
  onClose: () => void;
};

const Dialog = ({ children, onClose }: DialogProps) => {
  return (
    <Backdrop>
      <Content>
        <CloseButton onClick={onClose}>X</CloseButton>
        {children}
      </Content>
    </Backdrop>
  );
};
```

```
const Backdrop = styled.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  overflow-y: auto;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
`;

const CloseButton = styled.button`
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
`;

const Content = styled.div`
  position: relative;
  width: 20rem;
  min-height: 7rem;
  max-height: 80vh;
  background-color: white;
  border-radius: 0.5rem;
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  display: flex;
  flex-direction: column;
  margin: 0 1rem;
`;
```

### Adding enter animation

```
const fadeIn = keyframes`
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1);}
`;

const Content = styled.div`
  ...
  animation: ${fadeIn} 150ms ease-in;
`;
```

### Adding exit animation

We will need a state `isClosing` that refers to when the user closed the dialog. This will be accompanied by a setTimeout, where, after a certain amount of time, we will set `isOpen` to false.

```
const timeoutId = React.useRef<number>(0);

const onClose = () => {
  setIsClosing(true);
  timeoutId.current = window.setTimeout(() => {
    setIsOpen(false);
    setIsClosing(false);
  }, 150);
};

React.useEffect(() => {
  return () => {
    clearTimeout(timeoutId.current);
  };
}, []);
```

Then, we will pass `$isClosing` to the Dialog component

```
{isOpen && (
  <Dialog onClose={onClose} $isClosing={isClosing}>
    Dialog content
  </Dialog>
)}
```

```
const Content = styled.div<{ $isClosing: boolean }>`
  ...
  animation: ${fadeIn} 150ms ease-in;
  ${({ $isClosing }) => {
    if ($isClosing)
      return css`
        animation: ${fadeOut} 150ms ease-in forwards;
      `;
  }};
`;
```

### Increasing the readability

If we want the code to be more readable and easier to understand, we can do the following:

Pass `isOpen` to Dialog

```
<Dialog onClose={onClose} isOpen={isOpen} isClosing={isClosing}>
  Dialog content
</Dialog>
```

Pass the same prop to Content styled component:

```
<Content $isOpen={isOpen} $isClosing={isClosing}>
  <CloseButton onClick={onClose}>X</CloseButton>
  {children}
</Content>
```

And handle the animations this way

```
const Content = styled.div<{ $isOpen: boolean; $isClosing: boolean }>`
  ...
  animation-duration: 150ms;
  animation-timing-function: ease-in;
  animation-fill-mode: forwards;
  animation-name: ${({ $isOpen, $isClosing }) => {
    if ($isOpen && !$isClosing) return fadeIn;
    if ($isClosing) return fadeOut;
  }};
`;
```
